<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layout/default}">

<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
	
<!-- css -->
<style type= "text/css">
	.col-lg-1{
		padding: 0;
	}
	.col-lg-3{
		padding: 40px;
	}
	hr{
		height: 150px;
		width: 0px;
		border : 1px solid #d2d2d2	;
		background-color: #d2d2d2	;
	}
	.wrap {
		text-align: center;
	}
	.wrap p{
		font-size: 20px;
	}
	.wrap p span{
		font-size: 25px;
		color: #585858;
		font-weight: bold;
	}
	.btn{
		margin : 5px;
		color: #505050;
		background-color: #50508C;
		color: #fff;
		width: 120px;
	}
	.listWrap{
		text-align: center;
	}
	.list{
		display: inline-block;
		width: 200px;
		height: 200px;
		margin: 20px;
		padding: 40px;
	}
	.level{
		color: #46649B;
		font-weight: bold;
		cursor: pointer;
	}
	.bi-emoji-sunglasses{
		color: #FF9E9B;
	}
	.bi-hand-thumbs-up{
		color: #FFB2AF
	}
	.bi-heart-fill{
		color: #FFC6C3
	}
	.bi-person-x{
		color: #FFDFDC
	}
	.card1{
	    background-color: #BECDFF;
	    padding: 15px;
	}
	.card2{
		padding-bottom: 20px;
	}
	.profile{
    	text-align: center;
    	padding-top: 50px;
	}
	h1, h2{
    	text-align: center;
	}
	h4{
		cursor: pointer;
	}
	.membership{
		margin-top: 60px;
		cursor: pointer;
	}
</style>
</th:block>


<!-- contents layout:fragment 정의 -->
<th:block layout:fragment="customContents">
		<!-- 왼쪽부분 -->
	<input type="hidden" id="SID" th:value="${session.SID}">
	<div class="row">
	<div class="col-lg-4">
	<div class="card card1">	
				<h1><i class="bi bi-person-square"></i></h1>
		        <h1>[[${session.SNAME}]] 님 </h1>
		        <h2> 안녕하세요! </h2>
	</div>
    </div>
    <div class="col-lg-7">
    <div class="card card2"> 
    <div class="row">
    			<div class="col-lg-4 profile">
			        <h5 class="membership">멤버쉽 변경 이력 ></h5>
			        <h1  class="level">[[${memberUser.membership.msLevel}]]</h1>
    			</div>			 		
					<div class="col-lg-3">
	   			 		<div class="wrap">
	    			 		<h4>주문건수</h4>
	    			 		<p>[[${memberUser.userOrderTotal}]]</p>
	   			 		</div>
	   			 	</div>
	            	<div class="col-lg-1"><hr></div>
          			 	<div class="col-lg-3">
          			 		<div class="wrap">
          			 		<a th:href="@{/point/userAddPointList(userId=${session.SID})}">
	           			 		<h4>POINT</h4>
	           			 		<p><span>[[${memberUser.userPoint}]]</span> P</p>
	           			 	</a>
           			 		</div>
          			 	</div>
	            	<div class="col-lg-1"></div>
            		
          			 	</div>
	</div>
	</div>
	</div>
		<!-- 여기에 멤버쉽 변경이력 나타남 -->
			<div id="membershipDel"></div>
		<!-- 끄으으읕 -->
		<div class="card card-outline-primary" >
    		<!-- 프로필 하단 -->
   			 <div class="listWrap">
   			 	<div class="list"><a th:href="@{/member/myInfo(memberId=${session.SID})}"><i class="bi bi-emoji-sunglasses f-s-60"></i><h4>내정보</h4></a></div>
   			 	<div class="list"><a th:href="@{/member/modifyUserLike(userId=${session.SID})}"><i class="bi bi-hand-thumbs-up f-s-60"></i><h4>추천 / 비추천</h4></a></div>
   			 	<div class="list"><a th:href="@{#}"><i class="bi bi-heart-fill f-s-60"></i><h4>좋아요</h4></a></div>
   			 	<div class="list"><a th:href="@{/member/deleteMember(memberId=${session.SID})}"><i class="bi bi-person-x f-s-60"></i><h4>회원탈퇴</h4></a></div>   			 	
   			 </div>
        </div>

</th:block>


<th:block layout:fragment="customJsLib">
	<script th:src="@{/js/lib/owl-carousel/owl.carousel.min.js}"></script>
    <script th:src="@{/js/lib/owl-carousel/owl.carousel-init.js}"></script>
	<script type="text/javascript">
		$(function(){
    	
			$('.level').click(function(){

				var level= '';
				
				level += '<h3 style="font-weight: bold; color: #1E3269;"><i class="bi bi-tag"></i>브론즈</h3>';
				level += '<p style="font-size:15px">1분기 기준 주문/예약 횟수 0번 이상 30번 미만</p>';
				level += '<div style="background-color: #FFB4B4; width: 100px; height: 50px; text-align: center; line-height: 50px; font-size:15px;  margin-left:60px;">1% 적립</div>';

				level += '	<h3 style="font-weight: bold; color: #1E3269;"><i class="bi bi-tag"></i>실버</h3>';
				level += '	<p style="font-size:15px">1분기 기준 주문/예약 횟수 30번 이상 70번 미만</p>';
				level += '	<div style="background-color: #dcdcdc; width: 100px; height: 50px; text-align: center; line-height: 50px; display: inline-block;font-size:15px; margin-right:20px;">1% 적립</div>';
				level += '<div style="background-color: #dcdcdc; width: 160px; height: 50px; text-align: center; line-height: 50px; display: inline-block;font-size:15px">주문/예약시 5% 할인</div>';
				
				level += '<h3 style="font-weight: bold; color: #1E3269;"><i class="bi bi-tag"></i>골드</h3>';
				level += '<p style="font-size:15px">1분기 기준 주문/예약 횟수 70번 이상</p>';
				level += '<div style="background-color: #FDE6BE; width: 100px; height: 50px; text-align: center; line-height: 50px; display: inline-block;font-size:15px;  margin-right:20px;">1% 적립</div>';
				level += '<div style="background-color: #FDE6BE; width: 160px; height: 50px; text-align: center; line-height: 50px; display: inline-block;font-size:15px">주문/예약시 10% 할인</div>';

				Swal.fire(level);
				
			});
			
			//멤버쉽 누르면 변경이력 나타남
			$('.membership').click(function(){
				
				var userId = $('#SID').val();
				console.log(userId)
				
				var request =  $.ajax({
					  url: "/membershipDel", //요청 주소
					  method: "GET", //요청 방식
					  data: { userId : userId },
					  dataType: "json" //받아올 포맷방식
				});	
				request.done(function(data){
					console.log(data);
					
					var table= '';
   					
					table += '<div class="card card-outline-primary"><table class="table table-hover">';
					table += '<thead style="background-color: #585858; color: #fff; font-weight:bold;"><tr><td>멤버쉽 초기화 코드</td><td>초기화 전 총 누적횟수</td><td>초기화 전 멤버쉽 등급</td><td>초기화 일시</td></tr></thead>';
					table += '<tbody><tr>';            		
					table += '<td>' +data.membershipDel.msDelCode+ '</td>';        		
					table += '<td>' +data.membershipDel.delBeforeCount+ '</td>';
					table += '<td>' +data.membership.msLevel+ '</td>';
					table += '<td>' +data.membershipDel.resetTime+ '</td>';
					table += '</tr></tbody>';
			        table += '</table></div>';
   				
			      console.log(table,'table')
   					$('#membershipDel').html(table);	
				});
				//응답 실패
				request.fail(function(request,status,error){
			        alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			    });
			});
			
		});
	</script>
</th:block>
</html>