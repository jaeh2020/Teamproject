<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layout/default}">

<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
	
		<!-- css -->
<style type= "text/css">
	tbody tr td{
		color: #505050;
	}
	.btn-primary{
		display : block;
		float : right;
		color: #fff;
		margin: 5px;
	}
</style>

</th:block>


<!-- contents layout:fragment 정의 -->
<th:block layout:fragment="customContents">
	

	<div class="row justify-content-center">
		<div class="col-md-6">
			<div class="card card-outline-primary">
				<div class="card-title">
					<div class="card-header">
	                	<h4 class="m-b-0 text-white">메뉴 등록하기</h4>
	                </div>
				</div>
				<form id="addMenuForm" th:action="@{/store/addMenu}" method="post">
					<div class="card-body">
						<div class="basic-form">
								<div>
									<label> <span class="text-danger">*</span> 는 필수 항목입니다. </label>
								</div>
								
								<div class="form-group">
									<label>매장 선택 <span class="text-danger">*</span> </label>
										<select class="form-control" id="storeCode" name="storeCode">
				                        	<option value=""> : : : 선택  : : : </option>
											<th:block th:each="s : ${storeList}">
				                        	<option th:value="${s.storeCode}"> [[${s.storeName}]] : [[${s.bizId}]] </option>
				                        	</th:block>
				                        </select>
								</div>
								<div class="form-group">
									<label>소상공인 아이디 <span class="text-danger">*</span> </label>
										<select class="form-control" id="bizId" name="bizId">
				                        	<option value=""> : : : 선택  : : : </option>
											<th:block th:each="s : ${storeList}">
				                        	<option th:value="${s.bizId}"> [[${s.bizId}]] </option>
				                        	</th:block>
				                        </select>
								</div>
								<div class="form-group">
									<label>메뉴 대분류 <span class="text-danger">*</span> </label>
										<select class="form-control" id="selectMainCateCode" name="mainCateCode">
				                        	<option value=""> : : : 선택  : : : </option>
											<th:block th:each="m : ${mainCate}">
				                        	<option th:value="${m.mainCateCode}"> [[${m.mainCateName}]] </option>
				                        	</th:block>
				                        </select>
								</div>
								<div class="form-group">
									<label>메뉴 카테고리 <span class="text-danger">*</span> </label>
										<select class="form-control" id="selectMenuCateCode" name="menuCateCode">
				                        	<option value=""> : : : 선택  : : : </option>
				                        	<option value="m_c_main"> 메인 메뉴 </option>
				                        	<option value="m_c_side"> 사이드/옵션 메뉴 </option>
				                        </select>
								</div>
								<div class="form-group">
									<label>메뉴명 <span class="text-danger">*</span> </label>
									<input type="text" name="menuName" class="form-control">
								</div>
								<div class="form-group">
									<label>가격  <span class="text-danger">*</span> </label>
									<input type="number" name="menuPrice" class="form-control">
								</div>
								<div class="form-group">
									<label>상세정보</label>
									<input type="text" name="menuDetail" class="form-control">
									<small class="form-control-feedback" style="color: red;"> 메뉴에 대한 정보 작성 ( 예) 떡볶이일경우 - 밀떡 ) </small>
								</div>
								<div class="form-group">
									<label>사용여부 <span class="text-danger">*</span> </label>
										<select class="form-control" id="selectMenuUsing" name="menuUsing">
			                                      <option th:text="Y" th:value="Y"></option>
			                                      <option th:text="N" th:value="N"></option>
			                             </select>
								</div>
								
								<div class="form-group">
									<button type="button" id="addMyMenuBtn" class="btn btn-primary btn-flat m-b-10">메뉴 등록</button>
								</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	
	
	
</th:block>					
					
<!--Custom JavaScript -->
<th:block layout:fragment="customJsLib">
	<script src="js/lib/owl-carousel/owl.carousel.min.js"></script>
    <script src="js/lib/owl-carousel/owl.carousel-init.js"></script>
    
    <script type="text/javascript">
    
   	/* 유효성검사 */ 
	$(function(){
			$('#addMyMenuBtn').click(function(){
				
				var mainCateCode = $('[name=mainCateCode]');
				var menuCateCode = $('[name=menuCateCode]');
				var menuName = $('[name=menuName]');
				var menuPrice = $('[name=menuPrice]');
				
				var bizId = $("#bizId option:checked").text().trim();
				var storeCodeBefore = $("#storeCode option:checked").text();
				var bizId2 = storeCodeBefore.substring(storeCodeBefore.lastIndexOf(':')+1).trim();
				
				if(bizId != bizId2){
					alert('매장과 소상공인아이디가 일치하지않습니다. 다시선택해주세요');
					return false;
					
					
				}else if(menuCateCode.val().trim() == ''){
					alert('메뉴 카테고리를 선택해주세요 .');
					return false;
					
				}else if(menuName.val().trim() == ''){
					alert('메뉴명을 입력해주세요.');
					menuName.focus();
					return false;
					
				}else if(menuPrice.val().trim() == ''){
					alert('메뉴가격을 입력해주세요.');
					menuPrice.focus();
					return false;
				}
				$('#addMenuForm').submit();	
			});
		});
		
	</script>

</th:block>
</body>
</html>